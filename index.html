<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TransPro AI | Universal Translator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc;
            color: #1e293b;
        }
        .brand-font { font-family: 'Plus Jakarta Sans', sans-serif; }
        .glass {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.4);
        }
        .editor-grid {
            background-image: radial-gradient(#e2e8f0 1px, transparent 1px);
            background-size: 24px 24px;
        }
    </style>

    <script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@18.2.0",
    "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
    "lucide-react": "https://esm.sh/lucide-react@0.292.0"
  }
}
</script>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel" data-type="module" data-presets="react">
import React, { useState, useEffect, useRef } from 'react';
import { createRoot } from 'react-dom/client';
import { 
  Languages, ArrowRightLeft, Volume2, Copy, Check, Loader2, 
  Mic, FileUp, Sparkles, Trash2, ChevronRight, Globe 
} from 'lucide-react';

const SUPPORTED_LANGUAGES = [
  { code: 'en', name: 'English' },
  { code: 'es', name: 'Spanish' },
  { code: 'fr', name: 'French' },
  { code: 'de', name: 'German' },
  { code: 'it', name: 'Italian' },
  { code: 'pt', name: 'Portuguese' },
  { code: 'ja', name: 'Japanese' },
  { code: 'ko', name: 'Korean' },
  { code: 'zh', name: 'Chinese' },
  { code: 'hi', name: 'Hindi' },
  { code: 'ar', name: 'Arabic' }
];

// Enhanced translation dictionary
const translationDict = {
  'de-en': {
    'hallo': 'hello', 'welt': 'world', 'ich': 'I', 'bin': 'am', 'ist': 'is', 'sind': 'are',
    'der': 'the', 'die': 'the', 'das': 'the', 'und': 'and', 'oder': 'or', 'aber': 'but',
    'nicht': 'not', 'ein': 'a', 'eine': 'a', 'von': 'of', 'zu': 'to', 'mit': 'with',
    'für': 'for', 'auf': 'on', 'in': 'in', 'an': 'at', 'bei': 'at', 'nach': 'after',
    'haben': 'have', 'sein': 'be', 'werden': 'become', 'können': 'can', 'müssen': 'must',
    'guten tag': 'good day', 'danke': 'thank you', 'bitte': 'please', 'ja': 'yes', 'nein': 'no'
  },
  'es-en': {
    'hola': 'hello', 'mundo': 'world', 'gracias': 'thank you', 'por favor': 'please',
    'sí': 'yes', 'no': 'no', 'buenos días': 'good morning', 'adiós': 'goodbye'
  },
  'fr-en': {
    'bonjour': 'hello', 'monde': 'world', 'merci': 'thank you', 's\'il vous plaît': 'please',
    'oui': 'yes', 'non': 'no', 'au revoir': 'goodbye'
  }
};

const TONES = ['Neutral', 'Professional', 'Casual', 'Academic', 'Creative'];

const simpleTranslate = (text, fromLang, toLang) => {
  const key = `${fromLang}-${toLang}`;
  const dict = translationDict[key] || {};
  
  const sentences = text.split(/([.!?])/);
  return sentences.map(sentence => {
    if (sentence.match(/[.!?]/)) return sentence;
    const words = sentence.split(/(\s+)/);
    return words.map(part => {
      if (part.match(/^\s+$/)) return part;
      const lower = part.toLowerCase();
      return dict[lower] || part;
    }).join('');
  }).join('');
};

const App = () => {
  const [sourceText, setSourceText] = useState('');
  const [translatedText, setTranslatedText] = useState('');
  const [sourceLang, setSourceLang] = useState('auto');
  const [targetLang, setTargetLang] = useState('en');
  const [tone, setTone] = useState('Neutral');
  const [loading, setLoading] = useState(false);
  const [isRecording, setIsRecording] = useState(false);
  const [copied, setCopied] = useState(false);

  const fileInputRef = useRef(null);
  const recognitionRef = useRef(null);

  useEffect(() => {
    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
    if (SpeechRecognition) {
      const recognition = new SpeechRecognition();
      recognition.continuous = true;
      recognition.interimResults = true;
      recognition.onresult = (event) => {
        let transcript = '';
        for (let i = event.resultIndex; i < event.results.length; ++i) {
          transcript += event.results[i][0].transcript;
        }
        setSourceText(prev => prev + transcript);
      };
      recognition.onend = () => setIsRecording(false);
      recognitionRef.current = recognition;
    }
  }, []);

  const handleTranslate = async () => {
    if (!sourceText.trim()) return;
    setLoading(true);
    
    try {
      await new Promise(resolve => setTimeout(resolve, 800));
      
      const fromLang = sourceLang === 'auto' ? 'de' : sourceLang;
      const translated = simpleTranslate(sourceText, fromLang, targetLang);
      
      setTranslatedText(translated);
    } catch (error) {
      console.error(error);
      setTranslatedText("Error: Translation failed.");
    } finally {
      setLoading(false);
    }
  };

  const toggleRecording = () => {
    if (isRecording) {
      recognitionRef.current?.stop();
    } else {
      try {
        recognitionRef.current?.start();
        setIsRecording(true);
      } catch (e) {
        alert("Microphone access denied or not supported.");
      }
    }
  };

  const handleFileUpload = async (e) => {
    const file = e.target.files?.[0];
    if (!file) return;
    try {
      const text = await file.text();
      setSourceText(text);
    } catch (err) { 
      console.error(err);
      alert('Error reading file');
    }
  };

  const speak = (text, lang) => {
    if (!text) return;
    window.speechSynthesis.cancel();
    const utterance = new SpeechSynthesisUtterance(text);
    utterance.lang = lang;
    window.speechSynthesis.speak(utterance);
  };

  return (
    <div className="min-h-screen flex flex-col bg-slate-50">
      <nav className="h-16 border-b bg-white flex items-center justify-between px-8 sticky top-0 z-50 shadow-sm">
        <div className="flex items-center gap-3">
          <div className="w-10 h-10 bg-indigo-600 rounded-xl flex items-center justify-center shadow-lg">
            <Languages className="text-white" size={24} />
          </div>
          <h1 className="brand-font text-xl text-slate-900 font-extrabold">TransPro <span className="text-indigo-600">AI</span></h1>
        </div>
        <div className="hidden md:flex items-center gap-2 px-3 py-1 bg-green-50 text-green-600 rounded-full border border-green-100">
            <div className="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div>
            <span className="text-[10px] font-bold uppercase tracking-widest">Free Translation Engine</span>
        </div>
      </nav>

      <main className="flex-1 p-6 md:p-10 max-w-7xl mx-auto w-full flex flex-col gap-6">
        <div className="glass p-4 rounded-3xl flex flex-wrap items-center gap-4 shadow-sm border border-white">
          <div className="flex items-center gap-2 bg-slate-100 p-1 rounded-2xl border">
            <select value={sourceLang} onChange={e => setSourceLang(e.target.value)} className="bg-transparent text-sm font-bold px-3 py-1 outline-none cursor-pointer">
              <option value="auto">Detect Language</option>
              {SUPPORTED_LANGUAGES.map(l => <option key={l.code} value={l.code}>{l.name}</option>)}
            </select>
            <div className="px-1 text-slate-300"><ArrowRightLeft size={14}/></div>
            <select value={targetLang} onChange={e => setTargetLang(e.target.value)} className="bg-transparent text-sm font-bold px-3 py-1 outline-none cursor-pointer">
              {SUPPORTED_LANGUAGES.map(l => <option key={l.code} value={l.code}>{l.name}</option>)}
            </select>
          </div>
          <select value={tone} onChange={e => setTone(e.target.value)} className="bg-slate-100 text-sm font-bold px-4 py-2 rounded-2xl outline-none cursor-pointer">
            {TONES.map(t => <option key={t} value={t}>{t} Tone</option>)}
          </select>
          <button onClick={() => fileInputRef.current?.click()} className="flex items-center gap-2 px-5 py-2.5 bg-white border rounded-2xl text-sm font-bold ml-auto hover:bg-slate-50 transition-all shadow-sm">
            <FileUp size={18} className="text-indigo-600" /> Upload txt
          </button>
          <input type="file" ref={fileInputRef} className="hidden" accept=".txt" onChange={handleFileUpload} />
        </div>

        <div className="grid grid-cols-1 lg:grid-cols-2 gap-8 flex-1">
          <div className="flex flex-col bg-white rounded-[2rem] shadow-xl border border-slate-200 overflow-hidden">
            <div className="p-5 border-b flex items-center justify-between bg-slate-50/50">
              <span className="text-[10px] font-black text-slate-400 uppercase tracking-widest flex items-center gap-2"><Globe size={14}/> Source Input</span>
              <button onClick={() => setSourceText('')} className="p-2 text-slate-300 hover:text-red-500 transition-colors" title="Clear All"><Trash2 size={18}/></button>
            </div>
            <textarea 
              value={sourceText} 
              onChange={e => setSourceText(e.target.value)} 
              placeholder="Paste text or start speaking..." 
              className="flex-1 p-8 text-xl text-slate-700 outline-none resize-none editor-grid leading-relaxed"
            />
            <div className="p-4 border-t flex gap-2">
              <button onClick={() => speak(sourceText, sourceLang)} className="p-3 bg-slate-50 text-slate-400 rounded-2xl hover:text-indigo-600 transition-colors"><Volume2 size={22}/></button>
              <button onClick={toggleRecording} className={`p-3 rounded-2xl transition-all ${isRecording ? 'bg-red-500 text-white animate-pulse' : 'bg-slate-50 text-slate-400 hover:text-indigo-600'}`}>
                <Mic size={22}/>
              </button>
            </div>
          </div>

          <div className="flex flex-col bg-slate-900 rounded-[2rem] shadow-2xl overflow-hidden">
            <div className="p-5 border-b border-slate-800 flex items-center justify-between">
              <span className="text-[10px] font-black text-slate-500 uppercase tracking-widest flex items-center gap-2"><Sparkles size={14} className="text-indigo-400"/> AI Result</span>
              {loading && <Loader2 size={16} className="text-indigo-400 animate-spin"/>}
            </div>
            <div className="flex-1 p-8 text-xl text-indigo-50 leading-relaxed whitespace-pre-wrap overflow-y-auto">
              {translatedText || <p className="text-slate-700 italic">Ready for translation...</p>}
            </div>
            <div className="p-5 bg-slate-800/40 border-t border-slate-800 flex items-center justify-between">
              <div className="flex gap-2">
                <button onClick={() => speak(translatedText, targetLang)} className="p-3 bg-slate-800 text-slate-500 rounded-2xl hover:text-indigo-300" disabled={!translatedText}><Volume2 size={22}/></button>
                <button onClick={() => { navigator.clipboard.writeText(translatedText); setCopied(true); setTimeout(() => setCopied(false), 2000); }} className="p-3 bg-slate-800 text-slate-500 rounded-2xl hover:text-indigo-300" disabled={!translatedText}>
                  {copied ? <Check size={22} className="text-green-400" /> : <Copy size={22} />}
                </button>
              </div>
              <button 
                onClick={handleTranslate} 
                disabled={loading || !sourceText} 
                className="px-10 py-4 bg-indigo-600 hover:bg-indigo-500 text-white text-sm font-black rounded-2xl shadow-xl flex items-center gap-3 transition-all active:scale-95 disabled:opacity-50"
              >
                {loading ? 'PROCESSING...' : 'TRANSLATE'} <ChevronRight size={20} />
              </button>
            </div>
          </div>
        </div>
      </main>
      <footer className="p-4 text-center border-t bg-white">
          <p className="text-[10px] font-bold text-slate-300 uppercase tracking-widest">Global Language Engine • Secure & Private</p>
      </footer>
    </div>
  );
};

const root = createRoot(document.getElementById('root'));
root.render(<App />);
    </script>
</body>
</html>
